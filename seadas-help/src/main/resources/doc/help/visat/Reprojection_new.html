<!--
  ~ Copyright (C) 2010 Brockmann Consult GmbH (info@brockmann-consult.de)
  ~
  ~ This program is free software; you can redistribute it and/or modify it
  ~ under the terms of the GNU General Public License as published by the Free
  ~ Software Foundation; either version 3 of the License, or (at your option)
  ~ any later version.
  ~ This program is distributed in the hope that it will be useful, but WITHOUT
  ~ ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  ~ FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
  ~ more details.
  ~
  ~ You should have received a copy of the GNU General Public License along
  ~ with this program; if not, see http://www.gnu.org/licenses/
  -->

<html>
<head>
    <title>SeaDAS Help - Reproject Tool</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="stylesheet" href="../style.css">
</head>

<body>
<table class="header">
    <tr class="header">
        <td class="header">&nbsp;
            Reproject
        </td>

        <td class="header" align="right"><a href="index.html"><img src="../images/SeaDASHeader.png"
                                                                   border="0"></a></td>
    </tr>
</table>

<br>

<table class="invisibletable">
    <tr>
        <td class="invisibletable" valign="top">

            <img src="../visat/images/icons/Reproject24.png" border="0">

        </td>

        <td class="invisibletable" valign="top">


            <p class="groupDetails">
                The Reproject tool creates a mapped file from an input source file.
            </p>

            <p class="groupLocation">
                Raster -> Reproject<br>
            </p>

        </td>
    </tr>
</table>
<br>
<hr>

<h4>Overview</h4>
<p>
    The Reproject tool enables the user to take any file (which contains geo-coding) and resample it into a new file with
    a user specified map projection. Some key parameters which the user can specify are: coordinate reference system (CRS),
    resolution, interpolation method, and geographic location. This tool is available both from the GUI and from the command
    line (<a href="../beam-gpf/org_esa_beam_gpf_operators_standard_reproject_ReprojectionOp.html" class="invisibleLink">GPT-Reproject</a>).
    Figure 1 illustrates the results of applying this tool to a level-2 file using an oblique stereographic projection. The
    greenish portion of the image is a surface reflectance band and the shape of the level-2 boundary can be seen in the
    projection. Land and water masking has been applies to pixels outside of the original level-2 file boundaries.

</p>


<table class="invisibletable">
    <tr class="invisibletable">
        <td class="invisibletable" align="center">
            <img src="images/Reproject00.png" border="0"> <br>
            <i>Figure 1. Projected scene of a level-2 file <br>(Oblique Sterographic)</i>
        </td>
    </tr>
</table>

<hr>
<h4>Things To Be Aware Of</h4>

<p>
    <b>Valid Pixels and NaNs</b><br>There is not a one-to-one correspondance between the pixels of the input file and
    those of the output reprojected file. To handle this, the Reproject tool masks out invalid pixels and ultimately
    reprojects only the valid pixels of the source file. This hidden automated pixel validation step is acheived using the following two
    criteria: the <b>valid pixel expression</b> and the designation of a <b>no-data value</b>.  You can view/modify this criteria by
    right-clicking on any band, and selecting <b>Properties</b>.  Alternatively you can view this with the <b>Band Info</b> tool (<i>Analysis > Band Info</i>)
    when selecting the band.

    In general this is the desired behavior, unless the valid pixel expression is masking on an ideal range, outside of which there
    may actually be valid data.  If you wish to include this out-of-range data in the reprojection then you will need to edit the
    valid pixel expression of the band(s) of the source file before reprojecting.  One example of this would be when creating true color
    images using surface reflectances.  Because the surface reflectance product is designed based on water leaving radiances for the ocean, pixels which image cloud tops
    can exceed a reflectance value of 1.  In this case, for the case of including bright clouds in your true color imagery, the valid
    pixel expression band(s) of the source file would need to be modified so as to not throw away values above 1.


</p>

<br>
<i><b>Statistics on Mapped Imagery</b></i>

<p>

</p>





<br>
<hr>
<br>
<h4>I/O Parameters Tab</h4>

<p>
    <img src="images/Reproject01.png"><br><br>
</p>


<br>
<i><b>Source File</b></i>

<p class="i1">
    <b>File Selector</b><br>This is the file to be reprojected and serves as the input file to the Reproject Tool. You
    may
    conveniently select one of the files currently loaded in SeaDAS using the drop down selector. In this case, a file
    reference number appears to the left of the file name indicating that it is a loaded file and not a direct system
    file. To select a file directly from your computer system, use the selector button to the right and navigate to the
    desired
    file. A file selected this way directly from your system will not have a file reference number displayed next to it.
    Note that a loaded file can differ from a system file (even though they may bear the same name) in that you may have
    made changes to the loaded file in SeaDAS and not saved them.
</p>


<br>
<i><b>Target File</b></i>

<p class="i1">
    <b>Name</b><br>This is the name of the reprojected file which will be generated. The default behavior appends
    "_reprojected" to the original filename.
</p>

<p class="i1">
    <b>Save as</b><br>Used to specify whether the target product should be saved to the file system. The
    combo box presents a list of file formats, currently BEAM-DIMAP, GeoTIFF, and HDF5.
    The text field allows to specify a target directory. (Note: if deselected this tool will run much faster as the
    reprojection
    does not actually occur at the time of run. Subsequently when the user opens a band in the reprojected file the
    reprojection
    occurs for that band only.)
</p>

<p class="i1">
    <b>Save CPD File Button</b><br>Save the current settings to a new cpd file name. Once saved, this new cpd file
    becomes the currently selected cpd file in the Schemes Panel. Additional save format options are CPT and PAL.
</p>

<p class="i1">
    <b>Directory</b><br>Location in which to save file. (Default is the last location in which a file was saved)
</p>

<p class="i1">
    <b>Open in SeaDAS</b><br>Used to specify whether the target product should be opened in VISAT. When the
    the target product is not saved, it is opened in VISAT automatically.
</p>


<br>


<p class="i1">

<hr>

<h4>Map Projection & Settings Tab</h4>
<p>
    <img src="images/Reproject04.png"><br><br>
</p>

<br>
<i><b>Coordinate Reference System (CRS)</b></i>

<p class="i1">
    <b>Custom CRS</b><br>
    Text.

<p class="i2">
    <b>Geodetic datum</b><br>
    Text.
</p>
<p class="i2">
    <b>Projection</b><br>
    Text.
</p>

<p class="i2">
    <b>CRS Parameters</b><br>
    Text.
</p>


</p>

<p class="i1">
    <b>Predefined CRS</b><br>
    Text.
</p>

<p class="i1">
    <b>Use CRS of file</b><br>
    Text.
</p>
<br>


<i><b>Output Settings</b></i>

<p class="i1">
    <b>Preserve resolution</b><br>
    Text.
</p>

<p class="i1">
    <b>Add delta lat/lon bands</b><br>
    Text.
</p>

<p class="i1">
    <b>Reproject tie-point grids</b><br>
    Text.
</p>

<p class="i1">
    <b>No-data value</b><br>
    Text.
</p>

<p class="i1">
    <b>Resampling method</b><br>
    Text.
</p>


<br>


<i><b>Output Information</b></i>

<p class="i1">
    <b>Scene width</b><br>
    Text.
</p>

<p class="i1">
    <b>Scene height</b><br>
    Text.
</p>

<p class="i1">
    <b>Center longitude</b><br>
    Text.
</p>

<p class="i1">
    <b>Center latitude</b><br>
    Text.
</p>

<p class="i1">
    <b>CRS</b><br>
    Text.
</p>

<p class="i1">
    <b>Show WKT</b><br>
    Text.
</p>


<br>


<hr>
<hr>
<h3>Reprojection Dialog</h3>

<p>
    Here the use can create new product with a projected Coordinate Reference System (CRS).
    If you want that the created product is also orthorectified use the
    <a href="Orthorectification.html">Orthorectification</a> command.
    If its your intention to create one product from multiple input products use the
    <a href="Mosaic.html">Mosaic Processor</a>.

<p>
    After the new product has been created, you can change to VISAT's
    <a href="ProductBrowser.html">Product Browser</a> in order to open
    an <a href="ProductSceneView.html">Image View</a> for a band of the new product.

<h4>I/O Parameters</h4>
<table border="0">
    <tr>
        <td style="border-width:0;" valign="top">
            <h5>Source Product</h5>

            <p class="i1">
                <b>Name:</b>
                Here the user specifies the name of the source product. The combo box presents
                a list of all products open in VISAT. The user may select one of these
                or, by clicking on the button next to the combo box, choose a product
                from the file system.

            <h5>Target Product</h5>

            <p class="i1">
                <b>Name:</b>
                Used to specify the name of the target product.
            </p>

            <p class="i1">
                <b>Save as:</b>
                Used to specify whether the target product should be saved to the file system. The
                combo box presents a list of file formats, currently BEAM-DIMAP, GeoTIFF, and HDF5.
                The text field allows to specify a target directory.
            </p>

            <p class="i1">
                <b>Open in VISAT:</b>
                Used to specify whether the target product should be opened in VISAT. When the
                the target product is not saved, it is opened in VISAT automatically.
            </p></td>
        <td style="border-width:0;" valign="top"><img src="images/ReprojectionIOParameters.png"></td>
    </tr>
</table>

<h4>Projection Parameters</h4>
<table border="0">
    <tr>
        <td style="border-width:0;" valign="top">
            <h5>Coordinate Reference System (CRS)</h5>

            <p class="i1">
                <b>Custom CRS:</b>
                The transformation used by the projection can be selected. Also the geodetic datum and
                transformation parameters can be set, if possible for the selected transformation.
            </p>

            <p class="i1">
                <b>Predefined CRS:</b>
                By clicking on the <b>Select...</b> button a new <a href="SelectCrsDialog.html">Select Coordinate
                Reference System</a> dialog is shown
                where a predefined CRS can be selected.
            </p>

            <p class="i1">
                <b>Use CRS of:</b>
                A product can be selected to use its projected Coordinate Reference System. This will have the effect
                that source product will cover the same geographic region on the same CRS. Which means that both
                products are collocated.
            </p>

            <h5>Output Settings</h5>

            <p class="i1">
                <b>Preserve resolution:</b>
                If unchecked the <b>Output Parameters...</b> is enabled and the upcoming
                <a href="ReprojectionOutputParametersDialog.html">Output Parameters</a> dialog lets you edit the output
                parameters like
                easting and northing of the reference pixel, the pixel size and the scene height and width.
            </p>

            <p class="i1">
                <b>Reproject tie-point grids:</b>
                Specifies whether or not the tie-point grids shall be included. If they are reprojected they will appear
                as bands in the target product and not any more as tie-point grids.
            </p>

            <p class="i1">
                <b> Add delta lat/lon bands:</b>
                Specifies whether or not delta latitude and longitude bands will be added to the target product.
                These are virtual bands, which can be used to assess the accuracy of the new geo-coding given
                by the Coordinate Reference System (CRS) with respect to the old geo-coding.
            </p>


            <p class="i1">
                <b>No-data value:</b>
                The default no-data value is used for output pixels in the projected band which have either no
                corresponding pixel in the source product or the source pixel is invalid.
            </p>

            <p class="i1">
                <b>Resampling Method:</b>
                You can select one resampling method for the projection.<br>
                For a brief description have a look at <a href="../general/ResamplingMethods.html">Resampling
                Methods</a>.
            </p>

            <h5>Output Information</h5>

            <p class="i1">
                Displays some information about the output, like scene width and height, the geographic coordinate of
                the scene center and short description of the selected CRS.<br>
                When clicking the <b>Show WKT...</b> button the corresponding Well-Known Text of the currently defined
                CRS is shown.
            </p>
        </td>
        <td style="border-width:0;" valign="top"><img src="images/ReprojectionProjectionParameters.png">
        </td>
    </tr>
</table>


<p>
    <img src="images/Reproject03.png"><br><br>
</p>


<p>
    <img src="images/Reproject05.png"><br><br>
</p>


<h4>Schemes and Palettes</h4>

<p>
    A <b>color palette</b> refers to a set of rgb color values with corresponding (preferably normalized) data values.
    A <b>color scheme</b> denotes which color palette to use, the minimum and maximum values to apply to the palette,
    and whether the palette is to be displayed with log or linear scaling.
</p><br>

<p>
    The color palettes are stored in color palette definition (cpd) text files. New cpd files can be created
    within SeaDAS as well as saved.
</p><br>

The color schemes are stored in the following text files(located in ~/.seadas/beam-ui/auxdata/color-palettes) :
<ul>
    <li>color_palette_schemes.txt : contains the schemes.
    </li>
    <li>color_palette_scheme_defaults.txt : a lookup table to set the scheme based on the band name</li>
    <li> color_palette_scheme_selector.txt: a lookup table to set the scheme in the scheme selector in the GUI</li>
</ul>

Note: All color schemes and cpd files are located in the .seadas directory
(~/.seadas/beam-ui/auxdata/color-palettes/). External cpd files can be copied into this directory and will show up
in SeaDAS when it is next launched. Scheme files can be hand-edited to add new schemes or modify existing ones.
</p>
<br><br>
<hr>
<h4>Editors</h4>

<p>
    The color manager contains 3 editor screens:
</p>
<ul>
    <li>Basic Editor:
        <ul>
            <li>load scheme</li>
            <li>load/save cpd file</li>
            <li>set range minimum maximum</li>
            <li>set scaling: log/linear</li>
            <li>reverse direction of color palette</li>
        </ul>
    </li>
    <li>Sliders Editor:
        <ul>
            <li>displays histogram on top of color-bar</li>
            <li>automatically or manually adjust individual value-color point pairs using movable sliders</li>
            <li>add/remove value-color point pairs</li>
            <li>generate statistics for minimum and maximum band data value</li>
        </ul>
    </li>
    <li>Table Editor:
        <ul>
            <li>change value-color point pairs using a text field table</li>
        </ul>
</ul>


<hr>
<h4>Basic Editor</h4>

<p>
    <img src="images/Reproject01.png"><br><br>
</p>

<b>Icons</b>
<ul>
    <li><img src="images/icons/Undo24.gif"> : resets to the default color scheme</li>
    <li><img src="images/icons/LogDisplay24.png"> : toggles between log and linear display, redistributing palette
        points accordingly
    </li>
    <!--<li><img src="images/icons/LogDisplay24.png"> :  applies current selected color scheme to other bands</li>-->
</ul>
<br>

<b>Scheme Panel</b>
<ul>
    <li><b>Standard Schemes Selector</b> : Select and load a pre-defined scheme. The
        loaded scheme name will be displayed directly above this selector. Any alteration to parameters subsequent to
        selection of a scheme will result in an asterisks displayed with the scheme name. <br><br>
        Note: this selector selects schemes from the 'color_palette_scheme_selector.txt' file,
        if the scheme was loaded by default then the scheme name comes from 'color_palette_scheme_defaults.txt' file.

    </li>
</ul>
<br>
<b>Cdp File Panel</b>
<ul>
    <li><b>Color Palette Selector</b> : Select a cpd file. Selector shows a visual representation of each color palette
        as a
        color bar. Hovering the mouse over a selection will display it's cpd file name.
    </li>
    <li><b>Load cpd file exact values</b> : selecting this checkbox will load in the cpd file values exactly as they
        are,
        replacing the currently loaded Minimum and Maximum range values as well as the log scaling with those of the cpd
        file. Unchecked, the behavior is to load in the palette, while maintaining the user selected log scaling, and
        redistribute the palette data points between the user currently selected Minimum and Maximum range values.
    </li>
    <li><b>Save CPD File Button</b> : save the current settings to a new cpd file name. Once saved, this new cpd file
        becomes the currently selected cpd file in the Schemes Panel. Additional save format options are CPT and PAL.
    </li>
    <li><b>Reverse Button</b> : reverses the direction of the color palette</li>
</ul>
<br>
<b>Range Panel</b>
<ul>
    <li><b>Min Textfield</b> : redistributes the palette using this minimum range value</li>
    <li><b>Max Textfield</b> : redistributes the palette using this maximum range value</li>
    <li><b>Set from Band Data Button</b> : redistributes the palette using band data statistics to determine the
        minimum and maximum range value.
    </li>
</ul>
<br>

<hr>
<h4>Sliders Editor</h4>

<p>
    <img src="images/Reproject02.png"><br><br>
</p>

<b>Sliders</b>
<ul>
    <li><b>Change Data Value</b> : left clicking a slider and moving it will alters it data value for that value-color
        point pair.
    </li>
    <li><b>Change Color</b> : left clicking a slider brings about a color dialog box to enable an alteration of the
        color
        for that value-color point pair.
    </li>
    <li><b>Add Value-Color Point Pair</b> : right click a slider to add a new point AFTER the slider clicked</li>
    <li><b>Remove Value-Color Point Pair</b> : right click a slider to remove that slider's value-color point pair</li>
</ul>

<p>
    <b>Rough Statistics</b> : this underlined selected option will appear in the information above the histogram display
    if the current statistics are rough statistics. Clicking on this will enable the running a complete band statistics
    which includes all pixel data value in the determination of the data minimum and maximum range. <br><br>
</p>

<b>Icons</b>
<ul>
    <li><img src="images/icons/Undo24.gif"> : resets to the default color scheme</li>
    <li><img src=img src="images/icons/LogDisplay24.png"> : toggles between log and linear display, redistributing
        palette points accordingly
    </li>
    <!--<li><img src="images/icons/MultiAssignBands24.gif"> :  applies current selected color scheme to other bands</li>-->
    <li><img src="images/icons/Auto95Percent24.gif"> : adjusts the sliders to cover 95% of all pixels in the band.</li>
    <li><img src="images/icons/Auto100Percent24.gif"> : adjusts the sliders to cover 100% of all pixels in the band.
    </li>
    <li><img src="images/icons/ZoomIn24V.gif"> : zoom in on the histogram display vertically</li>
    <li><img src="images/icons/ZoomOut24V.gif"> : zoom out on the histogram display vertically</li>
    <li><img src="images/icons/ZoomIn24H.gif"> : zoom in on the histogram display horizontally</li>
    <li><img src="images/icons/ZoomOut24H.gif"> : zoom out on the histogram display horizontally</li>
    <li><img src="images/icons/EvenDistribution.gif"> : distributes the sliders evenly between the first and the last
        slider.
    </li>
    <li><img src="images/icons/Information24.gif"> : toggles visibility of statistic information in histogram display
    </li>

</ul>
<br>

<hr>
<h4>Table Editor</h4>

<p>
    <img src="images/color_manager_table.png"><br><br>
</p>

For each value-color point pair the color and/or it's value can be changed with this editor.<br><br>
<b>Icons</b>
<ul>
    <li><img src="images/icons/Undo24.gif"> : resets to the default color scheme</li>
    <li><img src="images/icons/MultiAssignBands24.gif"> : toggles between log and linear display, redistributing palette
        points accordingly
    </li>
</ul>
<br>

<hr>

<h4>More Options</h4>

<ul>
    <li><a name="nodata" id="nodata"><b>No-data color</b></a> : selects no-data color for this band</li>
    <li><a name="histomatch" id="histomatch"><b>Histogram matching</b></a> : It is sometimes desirable to transform an
        image so that it's histogram matches that of a
        specified functional form. It is possible to apply an equalized or normalized
        histogram matching to images which can often improve image quality.
    </li>
    <li><b>Discrete colors</b> : use only the discrete colors as defined in the palette</li>
</ul>

<hr>

<h4>Preferences</h4>
<p>The following preferences GUI governs this Tool</p>

<p>
    <img src="images/color_palettes_preferences.png"><br><br>
</p>

<ul>
    <li>Currently the only option is whether to use the color-blind compliant palette as the default palette.
        (see color_palette_schemes.txt located in ~/.seadas/beam-ui/auxdata/color-palettes)
    </li>
</ul>

<hr>
<h4>RGB Image</h4>

<p>
    *Note: this section of the help page is slightly out of date - see <a href="../general/ReleaseNotes7.4.html"
                                                                          class="invisibleLink">SeaDAS 7.4 Release
    Notes</a></p>
<br>

<p>Images using separate R,G,B channels use obtain their colours from the samples of three arbitrary bands. In the
    editor, users
    can switch between the channels in order to edit the contrast stretch range and gamma value of each channel
    separately.</p>

<p align="center"><img src="images/ColManipRGB.png"></p>

<p>In this mode the sliders are used for contrast stretching in each of the R,G,B channels.
    In the <b>More Options</b> panels, you can adjust the <b><a href="#nodata">No-Data Colour</a></b> and
    <b><a href="#histomatch">Histogram Matching</a></b> for the final image. The <b>Source Band</b> and <b>Gamma</b>
    options
    apply to each channel. The gamma value is used to adapt the transfer function which quantises the band's
    sample values to colour values. A gamma value of <code>0.7</code> for the blue channel enhances most
    RGB images.
</p>


</body>
</html>